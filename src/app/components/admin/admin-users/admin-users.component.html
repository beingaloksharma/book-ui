<div class="user-management-container">
    <div class="page-header">
        <div class="header-content">
            <h2>User Management</h2>
            <p class="subtitle">Manage user access and roles</p>
        </div>
        <div class="stats-badge">
            <span class="count">{{ users.length }}</span>
            <span class="label">Total Users</span>
        </div>
    </div>

    <div *ngIf="loading" class="loading-state">
        <div class="cube-spinner">
            <div class="face front"></div>
            <div class="face back"></div>
            <div class="face right"></div>
            <div class="face left"></div>
            <div class="face top"></div>
            <div class="face bottom"></div>
        </div>
        <p>Loading User Data...</p>
    </div>

    <div *ngIf="!loading && users.length === 0" class="empty-state">
        <mat-icon class="empty-icon">group_off</mat-icon>
        <p>No users found in the system.</p>
    </div>

    <div *ngIf="!loading && users.length > 0" class="accordion-container">
        <mat-accordion class="user-accordion" multi>
            <mat-expansion-panel *ngFor="let user of users" class="user-panel" hideToggle>
                <mat-expansion-panel-header class="panel-header">
                    <div class="header-grid">
                        <div class="user-avatar-section">
                            <div class="avatar-3d">
                                <span>{{ user.name.charAt(0).toUpperCase() }}</span>
                            </div>
                            <div class="user-identity">
                                <span class="name">{{ user.name }}</span>
                                <span class="email">{{ user.email }}</span>
                            </div>
                        </div>

                        <div class="role-section">
                            <span class="role-badge" [ngClass]="user.role">
                                {{ user.role }}
                            </span>
                        </div>

                        <div class="status-section">
                            <div class="status-pill" [ngClass]="user.status">
                                <div class="dot"></div>
                                <span>{{ user.status }}</span>
                            </div>
                        </div>
                    </div>
                </mat-expansion-panel-header>

                <div class="panel-content">
                    <div class="detail-grid">
                        <div class="detail-item">
                            <span class="label">Username</span>
                            <span class="value">&#64;{{ user.username }}</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">User ID</span>
                            <span class="value code">{{ user.id }}</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Joined Date</span>
                            <span class="value">{{ user.created_at | date:'mediumDate' }}</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Last Updated</span>
                            <span class="value">{{ user.updated_at | date:'short' }}</span>
                        </div>
                    </div>

                    <div class="action-dock">
                        <button mat-flat-button [color]="user.status === 'active' ? 'warn' : 'primary'"
                            class="action-btn-3d" (click)="toggleStatus(user)">
                            <mat-icon>{{ user.status === 'active' ? 'block' : 'check_circle' }}</mat-icon>
                            {{ user.status === 'active' ? 'Block Access' : 'Restore Access' }}
                        </button>
                    </div>
                </div>
            </mat-expansion-panel>
        </mat-accordion>
    </div>
</div>